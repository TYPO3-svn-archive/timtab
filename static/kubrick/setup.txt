

plugin.tt_news {
  displayXML {
    rss091_tmplFile = {$plugin.tt_news.displayXML.rss091_tmplFile}
    rss2_tmplFile = {$plugin.tt_news.displayXML.rss2_tmplFile}
    rdf_tmplFile = {$plugin.tt_news.displayXML.rdf_tmplFile}
    atom03_tmplFile = {$plugin.tt_news.displayXML.atom03_tmplFile}
    atom1_tmplFile = {$plugin.tt_news.displayXML.atom1_tmplFile}

    # possibile values: rss091 / rss2 / rdf / atom03
    xmlFormat = {$plugin.tt_news.displayXML.xmlFormat}

    xmlTitle = {$plugin.tx_timtab.title}
    xmlLink = {$plugin.tx_timtab.homepage}
    xmlDesc = {$plugin.tx_timtab.tagline}
    xmlLang = {$plugin.tt_news.displayXML.xmlLang}
    xmlIcon = {$plugin.tt_news.displayXML.xmlIcon}
    xmlLimit = {$plugin.tt_news.displayXML.xmlLimit}
    xmlCaching = {$plugin.tt_news.displayXML.xmlCaching}

  #  title_stdWrap.wrap = <![CDATA[|]]>
  #  subheader_stdWrap.wrap = <![CDATA[|]]>
  }
}

#
#	$Id$
#
xmlnews = PAGE
xmlnews {
  typeNum = 100

  10 < plugin.tt_news
  10.pid_list >
  10.pid_list = {$plugin.tx_timtab.pidStorePosts}
  10.singlePid = {$plugin.tx_timtab.blogPid}
  10.defaultCode = XML
  10.catTextMode = 1
  10.catImageMode = 0


  config {
    disableAllHeaderCode = 1
    additionalHeaders = Content-type:application/xml
    xhtml_cleaning = 0
    admPanel = 0
  }
}


# tt_news
plugin.tt_news {
  templateFile = {$page.file.template_tt_news}
  
  singlePid = {$plugin.tx_timtab.blogPid}
  pid_list = {$plugin.tx_timtab.pidStorePosts}
  
  displayList.date_stdWrap.strftime = %B %d, %Y
  displaySingle {
  	date_stdWrap.strftime =  %A, %B %d, %Y at %I:%M %p
  	prevLinkTitle_stdWrap.wrap = |" rel="prev
    prevLinkLabel_stdWrap.wrap = |
    prevLink_stdWrap.wrap = <div class="alignleft">&laquo;&nbsp;|</div>

    nextLinkTitle_stdWrap.wrap = |" rel="next
    nextLinkLabel_stdWrap.wrap = |
    nextLink_stdWrap.wrap = <div class="alignright">| &nbsp;&raquo;</div>
    nextLink_stdWrap.addParams = 

  }
  limit = 10
  
  /*
  * Link configuration of tt_news
  * @description add year and month to path, no backpid
  * @author Ingo Renner
  */
  useHRDates = 1
  useHRDatesSingle = 1
  useSubCategories = 1
  dontUseBackPid = 1
  
  /*
  * AMENU Settings
  * @description Amenu should show non-archived and categories not be added to amenu
  * @author Lina Wolf
  */
	enableArchiveDate = 0
	disableCategoriesInAmenuLinks = 1
	amenuWithCatSelector = 0
  
  /*
  * CATMENU Settings
  * @description Display Timtab CATMENU. Link it automatically
  * @author Ingo Renner, Lina Wolf
  */
  catSelectorTargetPid = {$plugin.tx_timtab.catPid}
  displayCatMenu {
    mode = timtab
    catmenu_stdWrap.wrap = <li><h2 class="news-catmenu">Categories</h2>|</li>
  }
  
  
  /*
  * tt_news LIST Pagebrowser
  * @description Simplified Pagebrowser
  * @author Lina Wolf
  */
  pageBrowser {
  	showResultCount = 0
  	showFirstLast = 0
  	showRange = 0
  }

  _LOCAL_LANG.default {
    archiveHeader = Archives
  }
  
  /*
  timtab {
  	catsOfPostList = TEXT
  	catsOfPostList {
  		field = catsOfPostItem
  	}
  	catsOfPostItem = TEXT
  	catsOfPostItem {
  		field = title
  		typolink.parameter = 
  	}
  }
  */
}

#list all posts of the current month when in archive
[globalVar = GP:tx_ttnews|year > 0]
plugin.tt_news.limit = 100
[global]
[globalVar = GP:tx_ttnews|ps > 0]
plugin.tt_news.limit = 100
[global]
[globalVar = GP:tx_ttnews|cat > 0]
plugin.tt_news.categoryMode = 1
#plugin.tt_news.categorySelection = 
[global]

# posts list
temp.list < plugin.tt_news 
temp.list {
  code >
  code = LIST
}

plugin.tx_comments_pi1 {
	storagePid = {$plugin.tx_timtab.pidStoreComments}
	templateFile = {$page.file.template_comments}
	content_stdWrap.wrap = <div class="comment_content">|</div>
	 _LOCAL_LANG.default {
		pi1_template.add_comment = Leave a Reply
	}
}

#post single view
temp.single = COA
temp.single {
	10 < plugin.tt_news 
	10 {
	  code >
	  code = SINGLE
	}
	20 < plugin.tx_comments_pi1
	20 {
		templateFile = {$page.file.template_comments}
	}
}

# archives
temp.archives < plugin.tt_news 
temp.archives {
  code >
  code = AMENU
  # Fix for Bug #14715, Bugtracker
  categoryMode = 0
}

# categories
temp.categories  = HMENU
temp.categories {
	special = userfunction
	special {
			userFunc = tx_timtabCatMenuUserFunc->makeMenuArray
			catPid = {$plugin.tx_timtab.catPid}
			sourcePid = {$plugin.tx_timtab.pidStorePosts}
		  sortBy = tt_news_cat.sorting ASC
		  showEmpty = 0
		  recursive = 1
			startUid = {$plugin.loskin.startCategory}
	}
	wrap = <li class="categories"><h2>Categories</h2>|</li>
	
	1 = TMENU 
	1 {
		wrap = <ul>|</ul>
		NO {
			allWrap.dataWrap = <li class="cat-item cat-item-{field:uid}">|
			wrapItemAndSub = |</li>
			htmlSpecialChars = 1
		}
		ACT = 1
		ACT < .NO
		ACT {
			allWrap.dataWrap = <li class="cat-item cat-item-act cat-item-{field:uid}">|
		}
	}
	2 < .1
	3 < .1

}

# pagenav, default: 2 levels
temp.pagenav = HMENU
temp.pagenav.wrap = <li id="pagenav"><h2>Pages</h2>|</li>
temp.pagenav.1 = TMENU
temp.pagenav.1 {
  wrap = <ul>|</ul>
  expAll = 1
  noBlur = 1

  NO {
    wrapItemAndSub = <li class="page_item">|</li>
    ATagTitle.field = abstract // description // title
  }
}
temp.pagenav.2 = TMENU
temp.pagenav.2 {
  wrap = <ul> | </ul>
  noBlur = 1
  
  NO {
    allWrap = <li class="page_item">|</li>
    ATagTitle.field = abstract // description // title
  }
}

# filling markers
temp.blogTitle = TEXT
temp.blogTitle.value = {$plugin.tx_timtab.title}
temp.blogTagline = TEXT
temp.blogTagline.value = {$plugin.tx_timtab.tagline}
temp.blogHomepage = TEXT
temp.blogHomepage.value = {$plugin.tx_timtab.homepage}



temp.blogRoll = COA
temp.blogRoll {
	10 =< plugin.tx_timtab_pi1
	10 {
		pidList = {$plugin.tx_timtab.pidStorePosts}
	  header_stdWrap.wrap = |
	  dontWrapInDiv = 1
	}
	stdWrap.wrap = <li><h2>Blogroll</h2>|</li>
	stdWrap.required = 1
}

temp.footer = COA
temp.footer {
	wrap = <p>|</p>
	10 = TEXT
	10 {
		value = {$plugin.tx_timtab.title}
		typolink.parameter = {$plugin.tx_timtab.homepage}
		wrap (
		 |&#32;is proudly powered by 
				<a href="http://www.typo3.com" title="TYPO3 - inspiring people to share">TYPO3</a> and
				<a href="http://www.ingo-renner.com/" title="TIMTAB development">TIMTAB</a>
		)
	}
	20 = TEXT
	20 {
		value = Entries (RSS)
		typolink.parameter = {$plugin.tx_timtab.blogPid},100
	  wrap = <br />|
	}
	#TODO Add comments RSS
	x30 = TEXT
	x30 {
		value = Comments (RSS)
		typolink.parameter = {$plugin.tx_timtab.blogPid},300
		wrap = and&#32;|.
	}
}

# Timtab does not allow H1 Tags beside the main heading
lib.stdheader.10.1.fontTag = <h2{register:headerStyle}{register:headerClass}>|</h2>
lib.stdheader.10.2.fontTag = <h3{register:headerStyle}{register:headerClass}>|</h3>
lib.stdheader.10.3.fontTag = <h4{register:headerStyle}{register:headerClass}>|</h4>
lib.stdheader.10.3.fontTag = <h5{register:headerStyle}{register:headerClass}>|</h5>
lib.stdheader.10.5.fontTag = <h6{register:headerStyle}{register:headerClass}>|</h6>


# page cObject
page >
page = PAGE
page {
  typeNum = 0

  # <head>
  headTag = <head profile="http://gmpg.org/xfn/11">
  headerData {
    10 = TEXT
    10 {
    	wrap = <link rel="pingback" href="{$plugin.tx_timtab.homepage}/|" />
    	typolink.parameter = {$plugin.tx_timtab.blogPid},200
    	typolink.returnLast = url
    }
    
    20 = TEXT
    20 {
    	wrap = <link rel="alternate" type="application/rss+xml" title="{$plugin.tx_timtab.title} &raquo; Feed" href="{$plugin.tx_timtab.homepage}/|" />
    	typolink.parameter = {$plugin.tx_timtab.blogPid},100
    	typolink.returnLast = url
    }
		#TODO Add comments RSS
		
    x30 = TEXT
    x30 {
    	wrap = <link rel="alternate" type="application/rss+xml" title="{$plugin.tx_timtab.title} &raquo; Comments Feed" href="{$plugin.tx_timtab.homepage}/|" />
    	typolink.parameter = {$plugin.tx_timtab.blogPid},300
    	typolink.returnLast = url
    }
    
    #40 will be used for the feed of comments in single view
  }

  # <body>
  bodyTag = <body>
  10 = TEMPLATE
  10 {
    template = FILE
    template.file = {$page.file.template_std}
    
    workOnSubpart = DOCUMENT_BODY
  
    marks {
      PAGENAV < temp.pagenav
      ARCHIVES < temp.archives
      CATEGORIES < temp.categories
      BLOG_TITLE < temp.blogTitle
      BLOG_TAGLINE < temp.blogTagline
      BLOG_HOME < temp.blogHomepage
      POSTS_LIST < temp.list
      POST_SINGLE < temp.single
      BLOG_CONTENT_NORMAL < styles.content.get
      BLOG_CONTENT_RIGHT < styles.content.getRight
      BLOG_BLOGROLL < temp.blogRoll
      FOOTER < temp.footer
    } # end marks
  } # end page.10 (TEMPLATE)
  
  # add some 'dynamic' css
  includeCSS.file001 = {$page.file.css}
  CSS_inlineStyle (
    body { background: url(/{$page.file.kubrickbgcolor}); }
    #page { background: url(/{$page.file.kubrickbgwide}) repeat-y top; border: none; }
    #header { background: url(/{$page.file.kubrickheader}) no-repeat bottom center; margin: 0 !important; margin: 0 0 0 1px; padding: 1px; height: 198px; width: 758px; }
    #headerimg { margin: 7px 9px 0; height: 192px; width: 740px; }
    #footer { background: url(/{$page.file.kubrickfooter}) no-repeat bottom; border: none;}
  )
  
  config {
		baseURL = {$plugin.tx_timtab.homepage}
    # get XHTML compliant output
    xmlprologue = none
    doctype = xhtml_trans
    xhtml_cleaning = all
  
    # Spamprotection
    spamProtectEmailAddresses = -3
    spamProtectEmailAddresses_atSubst = <span>&#064;</span>
  
    # targets
    intTarget = {$PAGE_TARGET}
    extTarget = _blank
  
    # externalize js and css
    removeDefaultJS = external

    # advertise that we can receive Pingback
    #additionalHeaders = X-Pingback: {$plugin.tx_timtab.homepage}/?type=200

    # Admin Panel
    admPanel = 1
  } # end page.config
  
} # end page (PAGE)

config {
	tx_realurl_enable = 1
}

#remove cleargif
content.headerSpace = 0|0
content.space = 0|0

# homepage
[globalVar = TSFE:id = {$plugin.tx_timtab.homePid}]
page.10.template.file = {$page.file.template_main}
[global]

# single view
[globalVar = TSFE:id = {$plugin.tx_timtab.blogPid}]

page.10.template.file = {$page.file.template_single}

page.headerData {
	x40 = TEXT
  x40 {
  	wrap = <link rel="alternate" type="application/rss+xml" title="{$plugin.tx_timtab.title} &raquo; Comments Feed" href="{$plugin.tx_timtab.homepage}/|" />
  	typolink.parameter = {$plugin.tx_timtab.blogPid},400
  	typolink.returnLast = url
  }
}
[global]